<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ndut Mebel - Furniture Berkualitas</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background-color: #a2845e;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
      }

      .header-menu {
        background-color: #a2845e;
        padding: 8px 0;
        font-size: 12px;
        color: white;
      }

      .header-menu .container {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .menu-items {
        display: flex;
        gap: 15px;
        font-weight: bold;
        text-transform: uppercase;
      }

      .menu-item {
        color: black;
        text-decoration: none;
        padding: 5px 10px;
        border-radius: 3px;
        transition: all 0.3s ease;
        position: relative;
        cursor: pointer;
      }

      .menu-item:hover {
        background-color: rgba(255, 255, 255, 0.2);
        color: white;
      }

      /* Styling untuk menu protected */
      .menu-item.protected {
        background-color: rgba(40, 167, 69, 0.1);
        border: 1px solid rgba(40, 167, 69, 0.3);
      }

      .menu-item.protected:hover {
        background-color: rgba(40, 167, 69, 0.2);
        color: white;
      }

      /* Icon untuk menu protected */
      .menu-item.protected::before {
        content: "🔒 ";
        font-size: 10px;
        margin-right: 3px;
      }

      /* Login status indicator */
      .login-status {
        font-size: 11px;
        color: white;
        font-weight: normal;
      }

      .login-status.logged-in {
        color: #90ee90;
      }

      .login-status.not-logged-in {
        color: #ffb6c1;
      }

      /* Notification popup */
      .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 20px;
        background-color: #ffc107;
        color: #856404;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        z-index: 1000;
        display: none;
        font-weight: bold;
        font-size: 14px;
        max-width: 300px;
        animation: slideIn 0.3s ease-out;
      }

      @keyframes slideIn {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      .notification.success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }

      .notification.warning {
        background-color: #fff3cd;
        color: #856404;
        border: 1px solid #ffeaa7;
      }

      .notification.error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }

      .main-container {
        background-color: #a2845e;
        min-height: 100vh;
        padding: 30px 0;
      }

      .content-wrapper {
        background-color: #a2845e;
        padding: 40px;
        margin: 0 auto;
        max-width: 1200px;
      }

      .brand-section {
        display: flex;
        align-items: flex-start;
        gap: 40px;
        margin-bottom: 30px;
      }

      .left-column {
        flex: 1;
        display: flex;
        flex-direction: column;
      }

      .brand-info {
        margin-bottom: 30px;
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .brand-title {
        font-size: 48px;
        font-weight: bold;
        color: #2c1810;
        margin: 0;
        font-family: "Times New Roman", serif;
      }

      .chair-icon {
        width: 80px;
        height: 60px;
        background-color: #2c1810;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 32px;
        flex-shrink: 0;
      }

      .furniture-image-container {
        text-align: left;
        margin-bottom: 20px;
      }

      .furniture-image {
        width: 250px;
        height: 300px;
        background-color: #8b4513;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #d4a574;
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 15px;
        position: relative;
        overflow: hidden;
      }

      .furniture-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 10px;
      }

      .ndut-mebel-logo {
        background-color: #a2845e;
        color: #d4a574;
        padding: 15px 25px;
        border-radius: 8px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        letter-spacing: 2px;
      }

      .vision-mission-section {
        flex: 1;
        padding-left: 20px;
      }

      .vision-box,
      .mission-box {
        margin-bottom: 30px;
      }

      .vision-title,
      .mission-title {
        font-size: 18px;
        font-weight: bold;
        color: #2c1810;
        margin-bottom: 15px;
      }

      .vision-text {
        color: #2c1810;
        line-height: 1.6;
        font-size: 14px;
        margin-bottom: 20px;
      }

      .mission-list {
        color: #2c1810;
        line-height: 1.6;
        font-size: 14px;
        margin: 0;
        padding-left: 0;
      }

      .mission-list li {
        margin-bottom: 10px;
        list-style: none;
        position: relative;
        padding-left: 20px;
      }

      .mission-list li::before {
        content: counter(mission-counter) ".";
        counter-increment: mission-counter;
        position: absolute;
        left: 0;
        font-weight: bold;
      }

      .mission-list {
        counter-reset: mission-counter;
      }

      .contact-footer {
        background-color: #a2845e;
        padding: 20px;
        border-radius: 10px;
        margin-top: 40px;
        display: flex;
        justify-content: space-around;
        align-items: center;
        flex-wrap: wrap;
        gap: 20px;
      }

      .contact-item {
        display: flex;
        align-items: center;
        color: white;
        gap: 10px;
        font-size: 14px;
      }

      .contact-icon {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
      }

      .whatsapp-icon {
        background-color: #25d366;
      }

      .email-icon {
        background-color: #ea4335;
      }

      .location-icon {
        background-color: #4285f4;
      }

      .bottom-contact {
        background-color: #000000;
        padding: 20px 0;
        text-align: center;
        color: white;
        font-size: 12px;
        margin-top: 30px;
        width: 100vw;
        margin-left: calc(-50vw + 50%);
        border-radius: 0;
      }

      @media (max-width: 768px) {
        .brand-section {
          flex-direction: column;
          text-align: center;
        }

        .brand-info {
          justify-content: center;
        }

        .brand-title {
          font-size: 36px;
        }

        .furniture-image {
          width: 200px;
          height: 240px;
        }

        .contact-footer {
          flex-direction: column;
        }

        .menu-items {
          flex-wrap: wrap;
          gap: 8px;
        }

        .menu-item {
          font-size: 10px;
          padding: 3px 6px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header Menu -->
    <div class="header-menu">
      <div class="container">
        <div class="menu-items">
          <!-- SEMUA MENU DITAMPILKAN - JavaScript akan handle authentication -->

          <!-- Protected Routes (Memerlukan Login) -->
          <a
            href="/material/add"
            class="menu-item protected"
            data-protected="true"
          >
            TABEL DATA MATERIAL
          </a>
          <a
            href="/katalog/add"
            class="menu-item protected"
            data-protected="true"
          >
            TAMBAH DATA KATALOG
          </a>
          <a href="/katalog" class="menu-item protected" data-protected="true">
            KATALOG JENIS PRODUK
          </a>

          <!-- Public Routes (Dapat diakses tanpa login) -->
          <a href="/kursi" class="menu-item" data-protected="false">
            PRODUK KURSI
          </a>
          <a href="/deskripsi" class="menu-item" data-protected="false">
            DESKRIPSI
          </a>
          <a href="/deskripsi2" class="menu-item" data-protected="false">
            DESKRIPSI 2
          </a>
          <a href="/" class="menu-item" data-protected="false"> HOME </a>
        </div>
      </div>
    </div>

    <!-- Notification Popup -->
    <div id="notification" class="notification"></div>

    <!-- Main Container -->
    <div class="main-container">
      <div class="content-wrapper">
        <!-- Brand Section -->
        <div class="brand-section">
          <div class="left-column">
            <div class="brand-info">
              <h1 class="brand-title">Ndut Mebel</h1>
              <div class="chair-icon">
                <i class="fas fa-chair"></i>
              </div>
            </div>

            <div class="furniture-image-container">
              <div class="furniture-image">
                <img
                  src="../assets/image/hero.png"
                  alt="Wooden Chair"
                  onerror="this.parentElement.innerHTML='<div style=\'color: #d4a574; font-size: 18px; text-align: center; padding: 20px;\'>Wooden Chair<br/>Furniture Image</div>'"
                />
              </div>
            </div>
          </div>

          <!-- Vision Mission Section -->
          <div class="vision-mission-section">
            <div class="vision-box">
              <div class="vision-title">Visi:</div>
              <div class="vision-text">
                Menjadi penyedia furniture kayu berkualitas tinggi yang nyaman,
                fungsional, dan tahan lama untuk mendukung produktivitas
              </div>
            </div>

            <div class="mission-box">
              <div class="mission-title">Misi:</div>
              <ol class="mission-list">
                <li>
                  Menyediakan kursi kayu jati dengan desain ergonomis dan bahan
                  berkualitas.
                </li>
                <li>
                  Menghadirkan produk yang tahan lama dan mudah dirawat untuk
                  penggunaan jangka panjang.
                </li>
                <li>
                  Mendorong penggunaan material alami yang ramah lingkungan dan
                  berkelanjutan.
                </li>
              </ol>
            </div>
          </div>
        </div>

        <!-- Contact Footer -->
        <div class="contact-footer">
          <div class="contact-item">
            <div class="contact-icon whatsapp-icon">
              <i class="fab fa-whatsapp"></i>
            </div>
            <span>081255667890</span>
          </div>

          <div class="contact-item">
            <div class="contact-icon email-icon">
              <i class="fas fa-envelope"></i>
            </div>
            <span>ndutmebel@gmail.com</span>
          </div>

          <div class="contact-item">
            <div class="contact-icon location-icon">
              <i class="fas fa-map-marker-alt"></i>
            </div>
            <span>Purwodadi</span>
          </div>
        </div>

        <!-- Bottom Contact -->
        <div class="bottom-contact">
          📧 ndutmebel@gmail.com &nbsp;&nbsp;&nbsp; 📞 087527076742
        </div>
      </div>
    </div>

    <!-- JavaScript untuk Menu Authentication -->
    <script>
      // Status login dari Flask context
      const isLoggedIn = {{ 'true' if is_logged_in else 'false' }};
      const loginUrl = '/login'; // Sesuaikan dengan route login Anda
      const currentUser = '{{ username if is_logged_in else "" }}';

      // Protected routes yang memerlukan login
      const protectedRoutes = ['/material/add', '/katalog/add', '/katalog', '/materials'];

      console.log(' Menu Authentication System Initialized');
      console.log(' Login Status:', isLoggedIn);
      console.log(' Current User:', currentUser || 'Not logged in');
      console.log(' Protected Routes:', protectedRoutes);

      // Function untuk menampilkan notifikasi
      function showNotification(message, type = 'warning') {
        const notification = document.getElementById('notification');

        // Set content dan style
        notification.textContent = message;
        notification.className = `notification ${type}`;
        notification.style.display = 'block';

        // Auto hide setelah 4 detik
        setTimeout(() => {
          notification.style.display = 'none';
        }, 4000);

        console.log(`🔔 Notification: ${message} (${type})`);
      }

      // Function untuk handle redirect ke login
      function redirectToLogin(reason = 'Authentication required') {
        console.log(`🔄 Redirecting to login: ${reason}`);

        showNotification('Mengalihkan ke halaman login...', 'warning');

        setTimeout(() => {
          window.location.href = loginUrl;
        }, 2000);
      }

      // Function untuk handle menu click
      function handleMenuClick(event) {
        const link = event.target.closest('.menu-item');
        if (!link) return;

        const isProtected = link.getAttribute('data-protected') === 'true';
        const href = link.getAttribute('href');
        const menuText = link.textContent.trim();

        console.log(` Menu clicked: ${menuText}`);
        console.log(` Is Protected: ${isProtected}`);
        console.log(` Target URL: ${href}`);

        // Jika menu protected dan user belum login
        if (isProtected && !isLoggedIn) {
          event.preventDefault(); // Mencegah navigasi default

          console.log('❌ Access denied: User not logged in');

          // Tampilkan notifikasi dengan nama menu
          const cleanMenuName = menuText.replace('🔒 ', '');
          showNotification(`Login diperlukan untuk mengakses "${cleanMenuName}"`, 'warning');

          // Redirect ke login setelah delay
          redirectToLogin(`Access to ${cleanMenuName}`);

          return false;
        }

        // Jika menu public atau user sudah login
        if (!isProtected || isLoggedIn) {
          console.log('✅ Access granted');

          if (isLoggedIn && isProtected) {
            showNotification(`Mengakses ${menuText.replace('🔒 ', '')}...`, 'success');
          }

          // Biarkan navigasi normal terjadi
          return true;
        }
      }

      // Function untuk check auth status via API (optional)
      async function checkAuthStatus() {
        try {
          const response = await fetch('/api/auth/status');
          const data = await response.json();

          console.log('🔍 Auth Status Check:', data);

          // Update status jika berbeda
          if (data.is_logged_in !== isLoggedIn) {
            console.log('🔄 Auth status changed, reloading page...');
            location.reload();
          }

          return data.is_logged_in;
        } catch (error) {
          console.error('❌ Error checking auth status:', error);
          return isLoggedIn; // fallback ke status awal
        }
      }

      // Initialize saat DOM loaded
      document.addEventListener('DOMContentLoaded', function() {
        console.log('🚀 DOM loaded, initializing menu system...');

        // Attach event listener ke semua menu items
        const menuItems = document.querySelectorAll('.menu-item');

        menuItems.forEach((item, index) => {
          item.addEventListener('click', handleMenuClick);

          const isProtected = item.getAttribute('data-protected') === 'true';
          const menuText = item.textContent.trim();

          console.log(` Menu ${index + 1}: ${menuText} ${isProtected ? '(Protected)' : '(Public)'}`);
        });

        console.log(` Menu system initialized with ${menuItems.length} items`);

        // Show welcome message untuk logged in users
        if (isLoggedIn && currentUser) {
          setTimeout(() => {
            showNotification(`Selamat datang, ${currentUser}!`, 'success');
          }, 500);
        }

        // Periodic auth check (optional - setiap 5 menit)
        setInterval(checkAuthStatus, 300000);
      });

      // Handle page visibility change untuk refresh auth status
      document.addEventListener('visibilitychange', function() {
        if (!document.hidden) {
          checkAuthStatus();
        }
      });

      // Expose functions ke global scope untuk debugging
      window.ndutMenuSystem = {
        checkAuth: checkAuthStatus,
        showNotification: showNotification,
        isLoggedIn: isLoggedIn,
        currentUser: currentUser,
        protectedRoutes: protectedRoutes
      };
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
